
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Hydrodynamics &#8212; Scorpio  documentation</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/alabaster.css" />
    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Turbulence Driving" href="turbulence.html" />
    <link rel="prev" title="Welcome to Scorpio’s Documentation!" href="index.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <div class="section" id="hydrodynamics">
<span id="ch-hydro"></span><h1>Hydrodynamics<a class="headerlink" href="#hydrodynamics" title="Permalink to this headline">¶</a></h1>
<div class="section" id="introduction">
<h2>Introduction<a class="headerlink" href="#introduction" title="Permalink to this headline">¶</a></h2>
<p>Governing equations and corresponding variables used in the code are presented here.</p>
</div>
<hr class="docutils" />
<div class="section" id="conservation-forms">
<h2>Conservation Forms<a class="headerlink" href="#conservation-forms" title="Permalink to this headline">¶</a></h2>
<p>We begin with the compressible equations of pure hydrodynamics without viscosity for the conserved state vector,
<span class="math notranslate nohighlight">\(\boldsymbol{U} = (\rho, \rho \boldsymbol{u}, \rho E):\)</span></p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
\frac{\partial \rho}{\partial t} + \nabla \cdot (\rho \boldsymbol{u})&amp;= 0 , \\
\frac{\partial (\rho \boldsymbol{u})}{\partial t} + \nabla \cdot (\rho \boldsymbol{u} \boldsymbol{u}) + \nabla P +\rho \nabla \Phi &amp;=0, \\
\frac{\partial (\rho E)}{\partial t} + \nabla \cdot (\rho \boldsymbol{u} E + P \boldsymbol{u}) &amp;= - \rho \boldsymbol{u} \nabla \Phi. \label{eq:compressible-equations}
\end{align}\end{split}\]</div>
<p>Here <span class="math notranslate nohighlight">\(\rho, \boldsymbol{u}, T, p\)</span>
velocity, temperature, pressure
respectively, and <span class="math notranslate nohighlight">\(E = e + \boldsymbol{u} \cdot \boldsymbol{u} / 2\)</span> is the total
energy with <span class="math notranslate nohighlight">\(e\)</span> representing the internal energy.</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
\frac{\partial \rho_n}{\partial t} + \nabla \cdot (\rho_n \boldsymbol{u}_n)&amp;= 0 , \\
\frac{\partial (\rho_n \boldsymbol{u}_n)}{\partial t} + \nabla \cdot (\rho_n \boldsymbol{u}_n \boldsymbol{u}_n) + \nabla P_n +\rho_n \nabla \Phi
&amp;= - \alpha \rho_n \rho_i (\boldsymbol{v}_n - \boldsymbol{v}_i), \\
\frac{\partial E_n}{\partial t} + \nabla \cdot (\boldsymbol{u}_n E_n + P_n \boldsymbol{u}_n)
&amp;= - \rho_n \boldsymbol{u}_n \nabla \Phi + \frac{3 \alpha}{\mu_n + \mu_i} (\mu_i \rho_n P_i - \mu_n \rho_i P_n) + \frac{\alpha \mu_i}{\mu_n + \mu_i} \rho_n \rho_i (\boldsymbol{v}_n - \boldsymbol{v}_i)^2, \\
\frac{\partial \rho_i}{\partial t} + \nabla \cdot (\rho_i \boldsymbol{u}_i) &amp;= 0 , \\
\frac{\partial (\rho_i \boldsymbol{u}_i)}{\partial t} + \nabla \cdot ( (\rho_i \boldsymbol{u}_i \boldsymbol{u}_i) - \boldsymbol{B} \boldsymbol{B} )
+ \nabla (P_i + \frac{1}{2} |\boldsymbol{B}|^2 ) + \rho_i \nabla \Phi
&amp;= - \alpha \rho_n \rho_i (\boldsymbol{v}_i - \boldsymbol{v}_n), \\
\frac{\partial E_i}{\partial t} + \nabla \cdot [(E_i + P_i +\frac{1}{2} |\boldsymbol{B}|^2) \boldsymbol{u}_i ]
&amp;= - \rho_i \boldsymbol{u}_i \nabla \Phi + \frac{3 \alpha}{\mu_n + \mu_i} (\mu_n \rho_i P_n - \mu_i \rho_n P_i) + \frac{\alpha \mu_i}{\mu_n + \mu_i} \rho_n \rho_i (\boldsymbol{v}_n - \boldsymbol{v}_i)^2,\\
\frac{\partial \boldsymbol{B}}{\partial t} + \nabla \times (v_i \times \boldsymbol{B}) &amp;= 0,\\
\nabla \boldsymbol{B} &amp;= 0. \\
\label{eq:admhd-equations}
\end{align}\end{split}\]</div>
<p>In the above formulas <span class="math notranslate nohighlight">\(\rho_n, \mu_n, P_n, \boldsymbol{v_n}, \Gamma_n\)</span>, and <span class="math notranslate nohighlight">\(E_n=\frac{P_n}{\Gamma_n-1}+\frac{1}{2}\rho_n|\boldsymbol{u_n}|^2\)</span> respectively denote the mass density, molecular weight, thermal pressure,
velocity vector, specific heat ratio, and total energy density of neutrals. While <span class="math notranslate nohighlight">\(\rho_i, \mu_i, P_i, \boldsymbol{v_i}, \Gamma_i\)</span>, and <span class="math notranslate nohighlight">\(E_i=\frac{P_i}{\Gamma_i-1}+\frac{1}{2}\rho_i|\boldsymbol{v_i}|^2 + \frac{1}{2}|\boldsymbol{B}|^2\)</span> are the corresponding physical variables of ions, where <span class="math notranslate nohighlight">\(|\boldsymbol{B}|\)</span> is the magnetic field vector.
<span class="math notranslate nohighlight">\(\alpha=\alpha_0 max\left(1,\frac{|\boldsymbol{v_i}-\boldsymbol{v_n}|}{\boldsymbol{v_{\alpha}}}\right)\)</span> is the collision coefficient, in which <span class="math notranslate nohighlight">\(\alpha_0=\frac{1.9\times10^{-19}}{m_n+m_i} cm^3 s^{-1}\)</span> (where <span class="math notranslate nohighlight">\(m_n=\mu_n m_H, m_i=\mu_i m_H\)</span> with <span class="math notranslate nohighlight">\(m_H\)</span> being the mass of hydrogen atom in the unit of g)
, and <span class="math notranslate nohighlight">\(\boldsymbol{v_{\alpha}} = 19.0 km s^{-\)</span>}` is the value of the drift velocity at which the Langevin approximation breaks down. Here we assume <span class="math notranslate nohighlight">\(\mu_n=2.3\)</span> and <span class="math notranslate nohighlight">\(\mu_i= 29\)</span> and the
corresponding collision coefficient is <span class="math notranslate nohighlight">\(3.7\times10^{13} cm^3 s^{-1} g^{-1}\)</span>.</p>
<p>The finite volume method solve for conserved variables (density, momenta, total energy, and cell-centered magnetic fields). Primitive variables can be obtained easily (density, velocities, pressure, and cell-centered magnetic fields).</p>
</div>
<div class="section" id="hydrodynamics-data-structures">
<h2>Hydrodynamics Data Structures<a class="headerlink" href="#hydrodynamics-data-structures" title="Permalink to this headline">¶</a></h2>
<span id="table-constants"></span><table class="docutils align-default" id="id1">
<caption><span class="caption-number">Table 1 </span><span class="caption-text">constants:</span><a class="headerlink" href="#id1" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 26%" />
<col style="width: 26%" />
<col style="width: 13%" />
<col style="width: 35%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p><strong>variable</strong></p></th>
<th class="head"><p><strong>quantity</strong></p></th>
<th class="head"><p><strong>value</strong></p></th>
<th class="head"><p><strong>units</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">GravConst</span></code></p></td>
<td><p><span class="math notranslate nohighlight">\(G\)</span></p></td>
<td><p>4.3011d-3</p></td>
<td><p>km^2*pc/(s^2*Msun)</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">year</span></code></p></td>
<td><p><span class="math notranslate nohighlight">\(year\)</span></p></td>
<td><p>3.156e7</p></td>
<td><p>s</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">pc</span></code></p></td>
<td><p><span class="math notranslate nohighlight">\(pc\)</span></p></td>
<td><p>3.086e18</p></td>
<td><p>cm</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">Msun</span></code></p></td>
<td><p><span class="math notranslate nohighlight">\(M_sun\)</span></p></td>
<td><p>1.9e33</p></td>
<td><p>g</p></td>
</tr>
<tr class="row-even"><td></td>
<td></td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
<span id="table-code-units"></span><table class="docutils align-default" id="id2">
<caption><span class="caption-number">Table 2 </span><span class="caption-text">code units:</span><a class="headerlink" href="#id2" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 24%" />
<col style="width: 32%" />
<col style="width: 12%" />
<col style="width: 33%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p><strong>code units</strong></p></th>
<th class="head"><p><strong>quantity</strong></p></th>
<th class="head"><p><strong>value</strong></p></th>
<th class="head"><p><strong>units</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">[T]</span></code></p></td>
<td><p>9.78e5 yrs</p></td>
<td><p>3.086e13s</p></td>
<td><p>pc*s/km</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">[L]</span></code></p></td>
<td></td>
<td></td>
<td><p>pc</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">[M]</span></code></p></td>
<td></td>
<td></td>
<td><p>Msun</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">tff</span></code></p></td>
<td><p>sqrt(3*pi/(32*GravConst*rho))</p></td>
<td></td>
<td><p>free-fall time</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">B</span></code></p></td>
<td><p>Bphy/sqrt(4pi)</p></td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
<span id="table-variables"></span><table class="docutils align-default" id="id3">
<caption><span class="caption-number">Table 3 </span><span class="caption-text">variables:</span><a class="headerlink" href="#id3" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 26%" />
<col style="width: 26%" />
<col style="width: 13%" />
<col style="width: 35%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p><strong>variable()</strong></p></th>
<th class="head"><p><strong>quantity</strong></p></th>
<th class="head"><p><strong>int</strong></p></th>
<th class="head"><p><strong>units</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">density</span></code></p></td>
<td><p><span class="math notranslate nohighlight">\(\rho\)</span></p></td>
<td><p>1</p></td>
<td><p>[M_sun / pc^3]</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">momx</span></code></p></td>
<td><p><span class="math notranslate nohighlight">\(\rho v_x\)</span></p></td>
<td><p>2</p></td>
<td><p>[M_sun / pc^3 * km/s]</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">momy</span></code></p></td>
<td><p><span class="math notranslate nohighlight">\(\rho v_y\)</span></p></td>
<td><p>3</p></td>
<td><p>[M_sun / pc^3 * km/s]</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">momz</span></code></p></td>
<td><p><span class="math notranslate nohighlight">\(\rho v_z\)</span></p></td>
<td><p>4</p></td>
<td><p>[M_sun / pc^3 * km/s]</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">bx</span></code></p></td>
<td><p><span class="math notranslate nohighlight">\(B_x\)</span></p></td>
<td><p>5</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">by</span></code></p></td>
<td><p><span class="math notranslate nohighlight">\(B_y\)</span></p></td>
<td><p>6</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">bz</span></code></p></td>
<td><p><span class="math notranslate nohighlight">\(B_z\)</span></p></td>
<td><p>7</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">ene</span></code></p></td>
<td><p><span class="math notranslate nohighlight">\(E\)</span></p></td>
<td><p>8(i) 5(n)</p></td>
<td></td>
</tr>
</tbody>
</table>
<span id="table-coordtype"></span><table class="docutils align-default" id="id4">
<caption><span class="caption-number">Table 4 </span><span class="caption-text">coordType:</span><a class="headerlink" href="#id4" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 71%" />
<col style="width: 29%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p><strong>coordType</strong></p></th>
<th class="head"><p><strong>int</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">Cartesian</span></code></p></td>
<td><p>1</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">Cylindrical</span> <span class="pre">log</span> <span class="pre">r</span></code></p></td>
<td><p>2</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">Cylindrical</span> <span class="pre">uniform</span> <span class="pre">r</span></code></p></td>
<td><p>3</p></td>
</tr>
</tbody>
</table>
<span id="table-boundarytype"></span><table class="docutils align-default" id="id5">
<caption><span class="caption-number">Table 5 </span><span class="caption-text">boundaryType:</span><a class="headerlink" href="#id5" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 71%" />
<col style="width: 29%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p><strong>boundaryType</strong></p></th>
<th class="head"><p><strong>int</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">zero</span> <span class="pre">gradient</span></code></p></td>
<td><p>1</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">reflective</span></code></p></td>
<td><p>2</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">periodic</span></code></p></td>
<td><p>3</p></td>
</tr>
</tbody>
</table>
<span id="table-solvertype"></span><table class="docutils align-default" id="id6">
<caption><span class="caption-number">Table 6 </span><span class="caption-text">solverType:</span><a class="headerlink" href="#id6" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 71%" />
<col style="width: 29%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p><strong>solverType</strong></p></th>
<th class="head"><p><strong>int</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">exactHD</span></code></p></td>
<td><p>1</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">HLLHD</span></code></p></td>
<td><p>2</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">HLLCHD</span></code></p></td>
<td><p>3</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">HLLMHD</span></code></p></td>
<td><p>4</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">HLLDMHD</span></code></p></td>
<td><p>5</p></td>
</tr>
</tbody>
</table>
<span id="table-limitertype"></span><table class="docutils align-default" id="id7">
<caption><span class="caption-number">Table 7 </span><span class="caption-text">limiterType:</span><a class="headerlink" href="#id7" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 71%" />
<col style="width: 29%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p><strong>limiterType</strong></p></th>
<th class="head"><p><strong>int</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">zero</span></code></p></td>
<td><p>0</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">van</span> <span class="pre">Leer</span></code></p></td>
<td><p>1</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">fslop</span></code></p></td>
<td><p>2</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">minmod</span></code></p></td>
<td><p>2</p></td>
</tr>
</tbody>
</table>
<span id="table-eostype"></span><table class="docutils align-default" id="id8">
<caption><span class="caption-number">Table 8 </span><span class="caption-text">eosType:</span><a class="headerlink" href="#id8" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 71%" />
<col style="width: 29%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p><strong>eosType</strong></p></th>
<th class="head"><p><strong>int</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">isothermal</span></code></p></td>
<td><p>1</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">adiabatic</span></code></p></td>
<td><p>2</p></td>
</tr>
</tbody>
</table>
<span id="table-setting"></span><table class="docutils align-default" id="id9">
<caption><span class="caption-number">Table 9 </span><span class="caption-text">setting:</span><a class="headerlink" href="#id9" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 42%" />
<col style="width: 25%" />
<col style="width: 34%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p><strong>setting</strong></p></th>
<th class="head"><p><strong>int</strong></p></th>
<th class="head"><p><strong>notes</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">ndim</span></code></p></td>
<td><p>1/2/3</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">nbuf</span></code></p></td>
<td><ol class="arabic simple" start="2">
<li></li>
</ol>
</td>
<td><p>buffer zone</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">nstep</span></code></p></td>
<td><p>0</p></td>
<td><p>for MPI</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">variable</span></code></p></td>
<td><p>0</p></td>
<td><p>default</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">nMesh(1)/(2)/(3)</span></code></p></td>
<td><p>int</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">leftBdry(1)/(2)/(3)</span></code></p></td>
<td></td>
<td></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">rightBdry(1)/(2)/(3)</span></code></p></td>
<td></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">periods(1)/(2)/(3)</span></code></p></td>
<td><p>.true./.false.</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">reorder</span></code></p></td>
<td><p>.true./.false.</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">sndspd</span></code></p></td>
<td><p>int</p></td>
<td><p>soundspeed   [km/s]</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">CFL</span></code></p></td>
<td></td>
<td><p>CFL condition</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">gam</span></code></p></td>
<td><p>5.d0 / 3.d0</p></td>
<td><p>useless if isothermal</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">file_start</span></code></p></td>
<td></td>
<td><p>start time [Myrs]</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">time_end</span></code></p></td>
<td></td>
<td><p>end time   [Myrs]</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">dt_out</span></code></p></td>
<td></td>
<td><p>output time step</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">write_vtk</span></code></p></td>
<td><p>.true./.false.</p></td>
<td><p>vtk format output</p></td>
</tr>
</tbody>
</table>
<span id="table-turbulencedriving"></span><table class="docutils align-default" id="id10">
<caption><span class="caption-number">Table 10 </span><span class="caption-text">TurbulenceDriving:</span><a class="headerlink" href="#id10" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 36%" />
<col style="width: 20%" />
<col style="width: 45%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p><strong>setting</strong></p></th>
<th class="head"><p><strong>int</strong></p></th>
<th class="head"><p><strong>notes</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">DriveTurbulence</span></code></p></td>
<td><p>.true./.false.</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">DT_mode</span></code></p></td>
<td><p>0</p></td>
<td><p>Drive at begining</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">DT_mode</span></code></p></td>
<td><p>1</p></td>
<td><p>Drive periodically</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">dt_turb</span></code></p></td>
<td></td>
<td><p>turnover time</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">t_count_turb</span></code></p></td>
<td></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">t_accum_turb</span></code></p></td>
<td></td>
<td><p>turnover time/??</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">E_turb_tot</span></code></p></td>
<td></td>
<td><p>Total injected turbulence energy</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">E_turb</span></code></p></td>
<td></td>
<td><p>energy injected in each driving</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">zeta</span></code></p></td>
<td><p>0-1</p></td>
<td><p># of driving</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">DT_scale</span></code></p></td>
<td></td>
<td><p>k0 driving scale</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">n_turb</span></code></p></td>
<td></td>
<td><p># of driving</p></td>
</tr>
</tbody>
</table>
<span id="table-selfgravity"></span><table class="docutils align-default" id="id11">
<caption><span class="caption-number">Table 11 </span><span class="caption-text">SelfGravity:</span><a class="headerlink" href="#id11" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 36%" />
<col style="width: 20%" />
<col style="width: 45%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p><strong>setting</strong></p></th>
<th class="head"><p><strong>int</strong></p></th>
<th class="head"><p><strong>notes</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">SelfGravity</span></code></p></td>
<td><p>.true./.false.</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">sgBdryType</span></code></p></td>
<td><p>0</p></td>
<td><p>isolated[default]</p></td>
</tr>
<tr class="row-even"><td></td>
<td><p>1</p></td>
<td><p>periodic</p></td>
</tr>
</tbody>
</table>
<p>problem setup
p = NkT  !!! thermal energy per volume, N number density
u = p/(gamma-1), thermal energy density, gamma adiabatic index Cp/Cv
u = rho*kT/((gamma-1)*mu*mH)  (energy per volume)
K = Vu = M/rho*u = M*k*T/((gamma-1)*mu*mH) !!! M total mass, V total volume
U = -3/5*GravConst*M^2/(Jeans length) potential Energy of a uniform density cloud
Virial Equilibrium =&gt; 2K = abs(U)
Jeans length: sqrt(5.0*c_s^2/(2.0*pi*GravConst*rho))
Jeans mass = 4.0*pi/3.0*rho*(Jean’s length)^3
The corresponding volume density rho=68.4765 [Msun/pc^3]
Jeans length: Jlen = 0.5654 [pc]
Jeans mass: Jmass = 51.8439 [Msun]
critical mass-to-flux ratio: M/(Phi_B)=sqrt(5/2)/(3*pi*sqrt(GravConst))=2.5581
[Bphy] = 1.0 [sqrt(Msun)*km/(s*pc^1.5)] = 8.0405e-7 [G,sqrt(g/cm)/s]
Bcrit,phy=Jmass/(2.5581*pi*Jlen^2)=20.1799 [Bphy]= 16.22 uG
Bcode=Bphy/sqrt(4*pi)
The factor sqrt(4*pi) is absorbed in the definition of Bcode
Bcrit,code=20.1799/sqrt(4*pi)=5.6926 [code unit]
sound speed of neutrals: 0.344 km/s
sound speed of ions: 0.096 km/s</p>
<p>Within the routines that implement the hydrodynamics, there are
several main data structures that hold the state.
Units and initial conditions used in <a class="reference internal" href="#table-constants"><span class="std std-numref">Table 1</span></a>.</p>
<ul class="simple">
<li><p>interface variables: these are the time-centered interface states
returned by the Riemann solver. They are used to discretize some
non-conservative terms in the equations. These arrays are generally
called <code class="docutils literal notranslate"><span class="pre">q1</span></code>, <code class="docutils literal notranslate"><span class="pre">q2</span></code>, and <code class="docutils literal notranslate"><span class="pre">q3</span></code> for the x, y, and z
interfaces respectively.</p></li>
</ul>
</div>
</div>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="index.html">Scorpio</a></h1>








<h3>Navigation</h3>
<p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">Hydrodynamics</a></li>
<li class="toctree-l1"><a class="reference internal" href="turbulence.html">Turbulence Driving</a></li>
<li class="toctree-l1"><a class="reference internal" href="selfgravity.html">Self-gravity</a></li>
<li class="toctree-l1"><a class="reference internal" href="time_integration.html">Time Integration</a></li>
<li class="toctree-l1"><a class="reference internal" href="code_structure.html">Code Structure</a></li>
<li class="toctree-l1"><a class="reference internal" href="parallelization.html">Parallelization</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
      <li>Previous: <a href="index.html" title="previous chapter">Welcome to Scorpio’s Documentation!</a></li>
      <li>Next: <a href="turbulence.html" title="next chapter">Turbulence Driving</a></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2022, SFG.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 4.5.0</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="_sources/hydro.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>